(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b0be68e"],{"07ec":function(t,e,n){},"12a3":function(t,e,n){"use strict";var a=n("9101"),i=n.n(a);i.a},"37d3":function(t,e,n){"use strict";var a=n("07ec"),i=n.n(a);i.a},"3d79":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"jspluimbchart"},[n("el-container",[n("el-header",[n("el-row",[n("el-col",{attrs:{span:18}},[n("div",{staticClass:"grid-content"},[n("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.input1,callback:function(e){t.input1=e},expression:"input1"}},[n("template",{slot:"prepend"},[t._v("流程名称")])],2)],1)]),n("el-col",{attrs:{span:6,justify:"space-around"}},[n("div",{staticClass:"grid-content bg-purple-light"},[n("el-button",{attrs:{size:"small"},on:{click:t.clearall}},[t._v("清空")]),n("el-button",{attrs:{size:"small"},on:{click:t.reset}},[t._v("还原")]),n("el-button",{attrs:{size:"small"},on:{click:t.saveFlow}},[t._v("保存")])],1)])],1)],1),n("el-container",[n("el-main",{staticClass:"jsplumbchart-main"},[n("drop",{staticClass:"drop-workplace",attrs:{id:"workplace"},on:{drop:t.handleDrop}},[n("jsplumbchart",{ref:"jsplumbchart",attrs:{data:t.jsplumbchartOption},on:{modifyJsplumbchartOption:t.modifyJsplumbchartOption,modifyChart:t.modifyChart,nodedblClick:t.nodedblClick,handleDrop:t.handleDrop}})],1)],1),n("el-aside",{attrs:{width:"250px"}},[n("vaside")],1)],1)],1),n("stepdialog",{attrs:{data:t.dialogOption},on:{modifyFlowData:t.modifyFlowData}})],1)},i=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"right-aside"},[n("el-collapse",{attrs:{accordion:""}},t._l(t.stepList,(function(e,a){return"0"!=e.thisIcon.length?n("el-collapse-item",{key:a+"-gQuery",attrs:{"track-by":"$index",name:a}},[n("template",{slot:"title"},[n("i",{staticClass:"icon iconfont icon-ir-supply-chain"}),t._v(" "+t._s(e.group)+" "),n("span",{staticClass:"iconNavNub"},[t._v("("+t._s(e.thisIcon.length)+")")])]),t._l(e.thisIcon,(function(e,a){return n("drag",{key:a+"-drawNav",staticClass:"designIcon",attrs:{"data-index":a,"data-type":e.type,"transfer-data":{drawIcon:e}},on:{dragstart:t.handleDragstart}},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.name,placement:"top"}},[n("div",{staticClass:"item-step-icon"},[n("i",{class:t._f("iconFilter")(e.name)}),n("h4",[t._v(t._s(e.name))])])])],1)}))],2):t._e()})),1)],1)},r=[];function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u={source:"source",sqlsource:"sqlsource",sink:"sink",decision:"decision",validate:"validate",supplement:"supplement",sql:"sql",transform:"transform",filter:"filter",sample:"sample",lookup:"lookup",join:"join",starjoin:"starjoin",productjoin:"productjoin",aggregate:"aggregate",top:"top",union:"union",intersect:"intersect",minus:"minus",split:"split",Correlation:"Correlation",Summary:"Summary",gradientboogradientbostedtrees_predict:"gradientboogradientbostedtrees_predict",MultilayerPerceptronPredict:"MultilayerPerceptronPredict",MultilayerPerceptronTrain:"MultilayerPerceptronTrain",kmeans_predict:"kmeans_predict",kmeans_train:"kmeans_train"};function p(t){return t in u&&"iconTrue"}var f=function(t,e,n,a,i,s){var r=function(r){var o=e[r],l=t[r],u=s.$watch(l,(function(t){var e={};e[o]=t,i(l,t,c({},a,{},e))}));n.push(u)};for(var o in t)r(o)},d=n("4bf8"),m={data:function(){return{gqueryTree:[],stepList:[],cnObj:{}}},filters:{iconFilter:function(t){return"iconTrue"==p(t)?"icon iconfont icon-ir-d-"+t:"icon iconfont icon-ir-d-default"},updateTimeFilter:function(t){return moment(t).format("YYYY-MM-DD HH:mm:ss")}},mounted:function(){this.initData()},methods:{nodeIcon:function(){return type in nodeIconFont&&"iconTrue"},handleDragstart:function(){},start:function(){console.log("拖动开始")},drag:function(t,e){console.log("元素正在拖动")},initData:function(){var t=this;Object(d["c"])().then((function(e){t.stepList=t.getLeftAsideData(e.data.data,_.uniq(t.getGroupData(e.data.data)))}))},getLeftAsideData:function(t,e){var n=this;return _.map(e,(function(e){return{group:e,thisIcon:_.compact(n.getIconData(t,e))}}))},getGroupData:function(t){return _.map(t,(function(t){return t.tags[0]}))},getIconData:function(t,e){return _.map(t,(function(t){if(t.tags[0]==e)return t}))}}},h=m,g=(n("9481"),n("2877")),b=Object(g["a"])(h,s,r,!1,null,"2160a15e",null),y=b.exports,v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"jsplumb-chart"},[n("div",{staticClass:"cavansClass",attrs:{id:"cavans"}},[n("flowchartNode",{directives:[{name:"show",rawName:"v-show",value:"flowchartnode"==t.nodeType,expression:"nodeType=='flowchartnode'"}],attrs:{data:{stepData:t.stepData}},on:{dblClick:t.dblClick,copyNode:t.copyNode,delNode:t.delNode}})],1)])},D=[],j=function(t){var e=t.jsPlumb.getInstance({Container:t.container});return e.bind("click",(function(t){e.deleteConnection(t)})),e.bind("connection",(function(e){return t.completedConnect(),e})),e.bind("connectionDetached",(function(e){t.delConnections(e,(function(){}))})),e},k=n("2ef0"),O=n.n(k),C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flowchart-node",attrs:{id:"flowchartnode"}},t._l(t.stepData,(function(e,a){return n("div",{key:a,class:"designIconBig "+t.setClass(t.nodeClass(e.type)),style:"left:"+e.x+"px;top:"+e.y+"px;position:absolute;margin:0",attrs:{id:e.id,"data-sign":e.name,"data-type":e.type},on:{dblclick:function(n){return t.dblClick(e)}}},[n("i",{staticClass:"icon iconfont icon-ir-designIconBg designIconBg"}),n("i",{class:"iconTrue"==t.nodeIcon(e.type)?"icon iconfont icon-ir-d-"+e.type:"icon iconfont icon-ir-d-default",attrs:{id:"changeSte"}}),n("h4",{attrs:{title:e.name}},[t._v(t._s(e.name))]),n("h5",[t._v("ID:"+t._s(e.id))]),n("em",{staticClass:"icon iconfont icon-ir-copy",attrs:{id:"copeDes",title:"复制"},on:{click:function(n){return n.preventDefault(),t.copyNode(e)}}}),n("em",{staticClass:"fa fa-trash-o",attrs:{id:"removeDes",title:"删除"},on:{click:function(n){return t.delNode(e.id)}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:"split"==e.type,expression:"data.type=='split'"}],staticClass:"line-split",style:t.setLineSplit(e)})])})),0)},w=[];function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach((function(e){S(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x(t){switch(t){case"source":case"sqlsource":case"streaming_source":case"source_dummy":case"StartEvent":return"classD_A";case"sink":case"show":return"classD_B";case"union":case"intersect":case"starjoin":return"classD_C";case"decision":case"split":case"validate":return"classD_D";case"join":case"productjoin":case"minus":return"classD_E";case"dataflow":case"hawq":case"hive":case"mapreduce":case"shell":case"spark":case"event":case"exclusive":case"parallel":return"classW_C";default:return"classO"}}var L={source:"source",sqlsource:"sqlsource",sink:"sink",decision:"decision",validate:"validate",supplement:"supplement",sql:"sql",transform:"transform",filter:"filter",sample:"sample",lookup:"lookup",join:"join",starjoin:"starjoin",productjoin:"productjoin",aggregate:"aggregate",top:"top",union:"union",intersect:"intersect",minus:"minus",split:"split",Correlation:"Correlation",Summary:"Summary",gradientboogradientbostedtrees_predict:"gradientboogradientbostedtrees_predict",MultilayerPerceptronPredict:"MultilayerPerceptronPredict",MultilayerPerceptronTrain:"MultilayerPerceptronTrain",kmeans_predict:"kmeans_predict",kmeans_train:"kmeans_train"};function T(t){return t in L&&"iconTrue"}function E(t){switch(t){case"decision":case"split":return"classD_D1";case"validate":return"classD_D2";case"join":case"productjoin":return"classD_E1";case"minus":return"classD_E2";case"dataflow":return"classW_A"}}var R={strokeWidth:2,stroke:"#4e5568",joinstyle:"round",outlineColor:"white",outlineWidth:0},$={strokeWidth:3,stroke:"#ff4e4e",outlineColor:"white",outlineWidth:0},M={endpoint:["Dot",{radius:8}],connectorStyle:R,connectorHoverStyle:$,paintStyle:{stroke:"#4e5568",fill:"transparent",radius:6,lineWidth:6},isSource:!0,connector:["Flowchart",{stub:[5,5],gap:10,cornerRadius:5,alwaysRespectStubs:!0}],isTarget:!1,maxConnections:1,connectorOverlays:[["Arrow",{width:10,length:10,location:1}]]},N={endpoint:["Dot",{radius:6}],connectorStyle:R,connectorHoverStyle:$,paintStyle:{fill:"#4e5568"},isSource:!1,connector:["Straight",{stub:[5,5],gap:10,cornerRadius:5,alwaysRespectStubs:!0}],isTarget:!0,maxConnections:1,connectorOverlays:[["Arrow",{width:10,length:10,location:1}]]},z=function(t,e,n,a,i){t.deleteEveryEndpoint(),e.$nextTick((function(){n.forEach((function(e,n){var s=e.type,r=e.id;if("classD_A"==x(s))t.addEndpoint(r,{anchors:"RightMiddle",maxConnections:100},P({uuid:r+"outputorigin"},M));else if("classD_B"==x(s))t.addEndpoint(r,{anchors:"LeftMiddle"},P({uuid:r+"inputdestination"},N));else if("classD_C"==x(s)||"classW_C"==x(s))t.addEndpoint(r,{anchors:"LeftMiddle",maxConnections:-1},P({uuid:r+"inputdestination"},N)),t.addEndpoint(r,{anchors:"RightMiddle",maxConnections:-1},P({uuid:r+"outputorigin"},M));else if("classD_D1"==E(s)){var o=A(F(e.outputConfigurations,i));i.forEach(o,(function(e,n){t.addEndpoint(r,{anchors:e.value,maxConnections:-1,overlays:[["Label",{location:[3.5,0],label:e.key,cssClass:"endpointSourceLabelMult"}]]},P({uuid:r+e.key+"origin"},M))})),t.addEndpoint(r,{anchors:"LeftMiddle"},P({uuid:r+"inputdestination"},N))}else"classD_D2"==E(s)?(t.addEndpoint(r,{anchors:[1,.3,0,0],maxConnections:-1,overlays:[["Label",{location:[1.5,-.5],label:"ok",cssClass:"endpointSourceLabel"}]]},P({uuid:r+"okorigin"},M)),t.addEndpoint(r,{anchors:[1,.7,0,0],maxConnections:-1,overlays:[["Label",{location:[1.5,1.3],label:"error",cssClass:"endpointSourceLabel"}]]},P({uuid:r+"errororigin"},M)),t.addEndpoint(r,{anchors:"LeftMiddle"},P({uuid:r+"inputdestination"},N))):"classD_E1"==E(s)?(t.addEndpoint(r,{anchors:"RightMiddle",maxConnections:-1},P({uuid:r+"outputorigin"},M)),t.addEndpoint(r,{anchors:[0,.3,0,0],overlays:[["Label",{location:[-1,-.5],label:"left",cssClass:"endpointSourceLabel"}]]},P({uuid:r+"leftdestination"},N)),t.addEndpoint(r,{anchors:[0,.7,0,0],overlays:[["Label",{location:[-1,1.5],label:"right",cssClass:"endpointSourceLabel"}]]},P({uuid:r+"rightdestination"},N))):"classD_E2"==E(s)?(t.addEndpoint(r,{anchors:"RightMiddle",maxConnections:-1},P({uuid:r+"outputorigin"},M)),t.addEndpoint(r,{anchors:[0,.3,0,0],overlays:[["Label",{location:[-1,-.5],label:"input1",cssClass:"endpointSourceLabel"}]]},P({uuid:r+"input1destination"},N)),t.addEndpoint(r,{anchors:[0,.7,0,0],overlays:[["Label",{location:[-1,1.5],label:"input2",cssClass:"endpointSourceLabel"}]]},P({uuid:r+"input2destination"},N))):(t.addEndpoint(r,{anchors:"RightMiddle",maxConnections:-1},P({uuid:r+"outputorigin"},M)),t.addEndpoint(r,{anchors:"LeftMiddle",maxConnections:"sql"==s?-1:1},P({uuid:r+"inputdestination"},N)));t.draggable(r,{start:function(t){},drag:function(t){},stop:function(t){var e=t.el.style.top,n=t.el.style.left;a({x:parseInt(n.replace("px","")),y:parseInt(e.replace("px","")),id:t.el.attributes.id.nodeValue})}})}))}))},F=function(t,e){var n=[];return e.forEach(t,(function(t,e){n.push({key:e,value:t})})),n},A=function(t){var e=t.length,n=1,a=0;switch(e){case 21:case 20:case 19:case 18:case 17:n=4,a=-1.33;break;case 16:case 15:n=4,a=-1.25;break;case 14:case 13:case 12:n=3,a=-.73;break;case 11:n=2.5,a=-.65;break;case 10:n=2.5,a=-.6;break;case 9:case 8:n=2,a=-.45;break;case 7:n=1.8,a=-.2;break;case 5:n=2,a=-.33;break;case 6:n=2,a=-.35;break;case 4:case 3:n=1,a=.15;break;case 2:n=1,a=.25;break;case 1:n=1,a=.5;break;default:}for(var i=n/e,s=[],r=0;r<t.length;r++)s.push({key:t[r].key,value:[1,a,0,0]}),a+=i;return s},q=function(t,e,n,a){e.$nextTick((function(){n.forEach((function(e){t.connect({uuids:[e.source+e.sourceOutput+"origin",e.target+e.input+"destination"]})})),a()}))},U=function(t){var e="";return e="classD_A"==t?"t1Style":"classD_B"==t?"t3Style":"t2Style",e},H=function(t,e){return e.map(t,(function(t){return t.sourceOutput?t.sourceOutput=t.sourceOutput:t.sourceOutput="output","classD_C"==x(t.targetInput)&&(t.targetInput=t.source),t.input?t.targetInput=t.input:t.targetInput="input",t.input?t.input=t.input:t.input="input",t}))},V={watch:{data:function(t){this.stepData=t.stepData}},props:{data:{type:Object,default:{}}},components:{},data:function(){return{stepData:[],nodeClass:x,nodeIcon:T,setClass:U}},computed:{},mounted:function(){},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{delNode:function(t){this.$emit("delNode",t)},dblClick:function(t){this.$emit("dblClick",t)},copyNode:function(t){this.$emit("copyNode",t)},setLineSplit:function(t){if("split"==t.type){var e=O.a.toArray(t.outputConfigurations);switch(e.length){case 21:case 20:return"height: 280px; top: -100px;";case 19:case 18:case 17:return"height: 270px; top: -95px;";case 16:case 15:return"height: 270px; top: -90px;";case 14:case 13:case 12:return"height: 190px; top: -50px;";case 11:case 10:return"height: 155px; top: -43px;";case 9:case 8:return"height: 120px; top: -35px;";case 7:case 6:case 5:return"height: 120px; top: -25px;";default:return"height: 70px; top: 0px;"}}}}},B=V,W=(n("fa36"),Object(g["a"])(B,C,w,!1,null,null,null)),Z=W.exports,J=n("7d05");function Y(t,e){var n=t.getContainer(),a=n.parentNode,i=J(n,{smoothScroll:!1,bounds:!1,autocenter:!0,zoomDoubleClickSpeed:1,minZoom:.5,maxZoom:2,beforeWheel:function(t){return e}});return t.mainContainerWrap=a,t.pan=i,i.on("zoom",(function(e){var n=e.getTransform(),a=n.scale;t.setZoom(a)})),a.style.cursor="grab",a.addEventListener("mousedown",(function(){this.style.cursor="grabbing",a.addEventListener("mouseout",(function(){this.style.cursor="grab"}))})),a.addEventListener("mouseup",(function(){this.style.cursor="grab"})),i}var K={init:Y},G=K;function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){tt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function tt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var et={watch:{data:function(t){this.stepData=this.data.steps,this.links=this.data.links,this.nodeType=this.data.nodeType,this.operationType=t.operationType,this.containerRect=t.containerRect,this.isPanZoom=t.isPanZoom},stepData:function(t){this.$emit("modifyChart",{stepData:t,links:this.links})},links:function(t){this.$emit("modifyChart",{stepData:this.stepData,links:t})}},props:{data:{type:Object,default:{}}},components:{flowchartNode:Z},data:function(){return{jsplumbInstance:j({container:this.data.container,delConnections:this.delConnections,completedConnect:this.completedConnect,jsPlumb:this.data.jsPlumb}),stepData:[],links:[],nodeClass:x,nodeIcon:T,setClass:U,instanceZoom:"",nodeType:"",isPanZoomInit:!0,cssText:"",containerRect:"",isPanZoom:""}},computed:{},mounted:function(){},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){var t=this;this.$nextTick((function(){if(t.containerRect&&t.isPanZoom){var e=O.a.last(t.stepData),n=t.modifyNodePositon({x:e.x,y:e.y});t.stepData=O.a.map(O.a.cloneDeep(t.stepData),(function(t){return e.id==t.id?Q({},t,{x:n.x,y:n.y}):t})),t.$emit("modifyJsplumbchartOption",Q({},t.data,{steps:t.stepData,links:t.links,containerRect:""}))}t.drawJsplumbChart({jsplumbInstance:t.jsplumbInstance,self:t,flowData:t.stepData,links:t.links},(function(){if(t.getLinksData(),t.isPanZoomInit&&t.isPanZoom){if(G.init(t.jsplumbInstance,!t.isPanZoom),t.isPanZoomInit=!1,!t.data.matrix)return;t.canvasMoveTo(t.data.matrix,(function(e){t.jsplumbInstance.pan.moveTo(e.x,e.y),t.jsplumbInstance.pan.zoomAbs(e.x,e.y,e.scale)}))}}))}))},beforeDestroy:function(){},destroyed:function(){},methods:{getScale:function(t){var e,n=t.getContainer();if(t.pan){var a=t.pan.getTransform(),i=a.scale;e=i}else{var s=window.getComputedStyle(n).transform;e=s&&1*s.split(", ")[3]}return t.setZoom(e),e},modifyNodePositon:function(t){this.jsplumbInstance;var e=this.containerRect,n=this.getScale(this.jsplumbInstance),a=(t.x-e.left)/n,i=(t.y-e.top)/n;return a-=20,i-=25,{x:a,y:i}},canvasMoveTo:function(t,e){e(t)},setCavansMatrix:function(t){var e=O.a.filter(t,(function(t){return"source"==t.type}));return e[0].stepSettings&&e[0].stepSettings.matrix},setNodeTemplate:function(t){switch(t){case"flowchartnode":return Z;case"cepNode":return cepNode;default:}},drawJsplumbChart:function(t,e){var n=this;z(t.jsplumbInstance,t.self,t.flowData,(function(t){n.stepData=O.a.map(n.stepData,(function(e){return e.id==t.id?Q({},e,{x:t.x,y:t.y}):e}))}),O.a),q(t.jsplumbInstance,t.self,t.links,e)},completedConnect:function(){this.getLinksData()},delConnections:function(t,e){e(),this.getLinksData()},delNode:function(t){this.stepData=O.a.filter(O.a.cloneDeep(this.stepData),(function(e){return e.id!=t}))},dblClick:function(t){this.$emit("nodedblClick",t)},getLinksData:function(){this.links=H(O.a.map(this.jsplumbInstance.getAllConnections(),(function(t){return{name:t.id,source:t.sourceId,sourceOutput:t.endpoints[0].canvas.nextSibling.textContent,target:t.targetId,targetInput:t.target.dataset.type,input:t.endpoints[1].canvas.nextSibling.textContent}})),O.a)},reset:function(){this.stepData=[],this.links=[],this.jsplumbInstance.deleteEveryEndpoint("workplace")},copyNode:function(t){var e=Q({},t,{x:t.x+50,y:t.y+50,id:t.type+"_"+(this.stepData.length+1)+"_copy"});this.$emit("handleDrop",e)},setLineSplit:function(t){if("split"==t.type){var e=O.a.toArray(t.outputConfigurations);switch(e.length){case 21:case 20:return"height: 280px; top: -100px;";case 19:case 18:case 17:return"height: 270px; top: -95px;";case 16:case 15:return"height: 270px; top: -90px;";case 14:case 13:case 12:return"height: 190px; top: -50px;";case 11:case 10:return"height: 155px; top: -43px;";case 9:case 8:return"height: 120px; top: -35px;";case 7:case 6:case 5:return"height: 120px; top: -25px;";default:return"height: 70px; top: 0px;"}}}}},nt=et,at=(n("37d3"),Object(g["a"])(nt,v,D,!1,null,null,null)),it=at.exports,st=n("c1df"),rt=n.n(st),ot=n("27ae"),ct=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"step-dialog"},[n("el-dialog",{directives:[{name:"dialog-drag",rawName:"v-dialog-drag"}],staticClass:"designDialog",attrs:{title:"设置",visible:t.data.dialogVisible,"before-close":t.closeDialog,"close-on-click-modal":!1,"modal-append-to-body":!1},on:{"update:visible":function(e){return t.$set(t.data,"dialogVisible",e)},opened:t.showDailog}},[n("el-form",{ref:"ruleForm",staticClass:"elForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px","label-position":t.labelPosition}},[n("el-form-item",{attrs:{label:"节点名称",prop:"newName"}},[n("el-tooltip",{staticClass:"priorityMes",attrs:{placement:"top",effect:"dark"}},[n("div",{attrs:{slot:"content"},slot:"content"},[t._v('["节点显示名称，最长100"]')]),n("i",{staticClass:"el-icon-info"})]),n("el-input",{attrs:{name:"newName"},model:{value:t.ruleForm.newName,callback:function(e){t.$set(t.ruleForm,"newName",e)},expression:"ruleForm.newName"}})],1),n("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.data.nodeSetTab,(function(e,a){return n("el-tab-pane",{key:a,attrs:{name:a.toString(),label:e.lable}},[n("div",{attrs:{slot:"label"},slot:"label"},[n("i",{class:e.icon}),t._v(" "+t._s(e.title)+" ")]),n(t.setTabTemplate(e.name),{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],tag:"component",attrs:{data:{tab:e,step:t.data.step,targetInput:t.data.nodeSetTab[parseInt(t.activeName)].targetInput},"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}})],1)})),1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:t.closeDialog}},[t._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:t.setCurrentStep}},[t._v("确 定")])],1)],1)],1)},lt=[],ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"nodeTable block__list_tags",attrs:{id:"input"}},[n("div",{staticClass:"block__list block__list_words blockLeft"},[n("div",{staticClass:"block__list-title"},[n("span",[t._v("备选字段")]),n("el-input",{staticClass:"fieldsInput",attrs:{placeholder:"请输入字段名称","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(e){t.filtertTableData(t.searchAlternative,t.inputLeftData,t.getMapCheckedData(t.realtime.initInputData))}},model:{value:t.searchAlternative,callback:function(e){t.searchAlternative=e},expression:"searchAlternative"}}),n("i",{staticClass:"ns_fields3 icon iconfont icon-ir-copy",attrs:{title:"导入表格内字段"},on:{click:function(e){return t.inputFieldsImport(t.inputLeftData)}}}),n("i",{staticClass:"ns_fields1 el-icon-plus",attrs:{title:"新增已选字段"},on:{click:t.addInputLeft}})],1),n("ol",[[n("el-table",{ref:"multipleTableLeft",staticStyle:{width:"100%"},attrs:{data:t.inputLeftData.slice((t.inputLeftCurrentPage-1)*t.inputLeftPagesize,t.inputLeftCurrentPage*t.inputLeftPagesize),height:"25vh"},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{fixed:"",index:t.inputLeftIndexMethod,type:"index",width:"60"}}),n("el-table-column",{attrs:{prop:"name",label:"字段名"}}),n("el-table-column",{attrs:{type:"selection",width:"55"}})],1)]],2),n("el-pagination",{attrs:{small:"","current-page":t.inputLeftCurrentPage,"page-sizes":[10,20,50,100],"page-size":t.inputLeftPagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.inputLeftData&&t.inputLeftData.length},on:{"size-change":t.inputLeftHandleSizeChange,"current-change":t.inputLeftHandleCurrentChange}})],1),n("div",{staticClass:"block__list block__list_words blockRight"},[n("div",{staticClass:"block__list-title"},[n("span",[t._v("已选字段")]),n("el-input",{staticClass:"fieldsInput",attrs:{placeholder:"请输入字段名称","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(e){return t.filtertTableDataRight(t.searchright,t.inputRightData,t.inputRighCloneData)}},model:{value:t.searchright,callback:function(e){t.searchright=e},expression:"searchright"}}),n("span",{staticClass:"removeAllFields",attrs:{title:"删除全部已选字段"},on:{click:t.removeOutSelAllField}},[n("i",{staticClass:"fa fa-trash-o"})])],1),n("div",[n("ol",{attrs:{id:"input-2"}},[[n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.inputRightData.slice((t.inputRightCurrentPage-1)*t.inputRightPagesize,t.inputRightCurrentPage*t.inputRightPagesize),height:"25vh"}},[n("el-table-column",{attrs:{fixed:"",index:t.inputRightIndexMethod,type:"index",width:"60"}}),n("el-table-column",{attrs:{prop:"name",label:"字段名"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{class:e.row.isillegality?"righttb":""},[t._v(" "+t._s(e.row.name)+" ")])]}}])}),n("el-table-column",{attrs:{prop:"alias",label:"别名"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{attrs:{placeholder:"别名"},nativeOn:{keyup:function(n){return t.outAlias(e.row.alias,e.$index)}},model:{value:e.row.alias,callback:function(n){t.$set(e.row,"alias",n)},expression:"scope.row.alias"}})]}}])}),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-col",{staticClass:"removeFields",attrs:{span:3}},[n("i",{staticClass:"el-icon-close",on:{click:function(n){return t.removeOutSelThisField(e.row.name,e.$index)}}})])]}}])})],1)]],2),n("el-pagination",{attrs:{small:"","current-page":t.inputRightCurrentPage,"page-sizes":[10,20,50,100],"page-size":t.inputRightPagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.inputRightData&&t.inputRightData.length},on:{"size-change":t.inputRightHandleSizeChange,"current-change":t.inputRightHandleCurrentChange}})],1)]),n("p",[t._v("提示：别名允许的字符包括字母,数字和下划线.")]),0!=t.Missing.length?n("p",[t._v("缺失 "+t._s(t.Missing.length)+"个")]):t._e(),0!=t.Missing.length?n("p",{staticClass:"Missing"},[t._v(t._s(t.Missing.toString()))]):t._e(),0!=t.illegality.length?n("p",[t._v("非法 "+t._s(t.illegality.length)+"个")]):t._e(),0!=t.illegality.length?n("p",{staticClass:"illegality"},[t._v(t._s(t.illegality.toString()))]):t._e()])])},pt=[];function ft(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function dt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ft(Object(n),!0).forEach((function(e){mt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function mt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ht={watch:{"realtime.initInputData":function(t){this.inputLeftData=this.getMapCheckedDataLeft(t)},inputRightData:function(t){if(this.data.targetInput||(delete this.realtime.checkedinPUTData.left,delete this.realtime.checkedinPUTData.right,this.$store.dispatch("realtime/setInputCheckedData",{input:this.setMapCheckedData(t)})),"left"==this.data.targetInput){delete this.realtime.checkedinPUTData.input;var e={left:this.setMapCheckedData(t)};this.realtime.checkedinPUTData.right&&(e.right=this.realtime.checkedinPUTData.right),this.$store.dispatch("realtime/setInputCheckedData",e)}if("right"==this.data.targetInput){delete this.realtime.checkedinPUTData.input;var n={right:this.setMapCheckedData(t)};this.realtime.checkedinPUTData.left&&(n.left=this.realtime.checkedinPUTData.left),this.$store.dispatch("realtime/setInputCheckedData",n)}},"realtime.initCheckedinputData":function(t){t&&0!=t.length||(this.inputRightData=[]),this.inputRightData=this.getMapCheckedDataright(t),this.setInputRighCloneData(this.inputRightData)},data:function(t){this.searchAlternative="",this.searchright="",this.inputLeftData=this.getMapCheckedData(this.realtime.initInputData)}},props:{data:{type:Object,default:!1}},components:{},data:function(){return{inputLeftData:[],inputRightData:[],inputLeftCloneData:[],inputRighCloneData:[],inputLeftCurrentPage:1,inputLeftPagesize:10,inputRightCurrentPage:1,inputRightPagesize:10,searchAlternative:"",selectColumn:[],multipleSelection:[],searchright:"",inputRightTable:[],illegality:[],Missing:[]}},computed:{},mounted:function(){},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{setMissAndIllegality:function(t,e){this.Missing=this.setMissing(t,e),this.illegality=this.setIllegality(t,e)},mpaData:function(t){return _.map(t,(function(t){return t.column||t.name}))},setMapCheckedData:function(t){return _.map(t,(function(t){return{alias:t.alias,description:t.description,column:t.name,type:t.type}}))},getMapCheckedData:function(t){return _.map(t,(function(t){return{alias:t.alias,description:t.description,name:t.alias||t.column,type:t.type}}))},getMapCheckedDataright:function(t){return _.map(t,(function(t){return{alias:t.alias,description:t.description,name:t.column,type:t.type}}))},setMapCheckedDataright:function(t,e){var n=[];return _.forEach(t,(function(t){_.forEach(e,(function(e){t.name==e?n.push(dt({},t,{isillegality:!0})):n.push(dt({},t))}))})),n},setIllegality:function(t,e){return _.differenceWith(this.mpaData(e),this.mpaData(t),_.isEqual)},setMissing:function(t,e){return _.differenceWith(this.mpaData(t),this.mpaData(e),_.isEqual)},getMapCheckedDataLeft:function(t){return _.map(t,(function(t){return{alias:t.alias,description:t.description,name:t.column,type:t.type}}))},handleSelectionChange:function(t){this.multipleSelection=t},inputLeftFocus:function(){},inputLeftKeydown:function(){},getInputRow:function(t){return t.name},inputLeftHandleSizeChange:function(t){this.inputLeftPagesize=t},inputLeftHandleCurrentChange:function(t){this.inputLeftCurrentPage=t},inputLeftIndexMethod:function(t){return this.inputLeftPagesize*(this.inputLeftCurrentPage-1)+t+1},inputLefthandleSelectionChange:function(t){this.selectColumn=t},inputRightHandleSizeChange:function(t){this.inputRightPagesize=t},inputRightHandleCurrentChange:function(t){this.inputRightCurrentPage=t},inputRightIndexMethod:function(t){return this.inputRightPagesize*(this.inputRightCurrentPage-1)+t+1},inputFieldsImport:function(t){var e=this;this.$confirm("确认导入全部数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$message({type:"success",message:"导入成功!"}),e.inputRightData=t,e.setInputRighCloneData(t),document.querySelector(".v-modal").remove()})).catch((function(){e.$message({type:"info",message:"已取消"}),document.querySelector(".v-modal").remove()}))},setInputRighCloneData:function(t){this.inputRighCloneData=_.cloneDeep(t)},addInputLeft:function(){this.inputRightData=this.multipleSelection,this.setInputRighCloneData(this.multipleSelection)},removeOutSelAllField:function(){this.inputRightData=[],this.inputRighCloneData=[],this.$refs.multipleTableLeft.clearSelection()},removeOutSelThisField:function(t,e){this.inputRightData=_.filter(this.inputRighCloneData,(function(e){return e.name!=t})),this.setInputRighCloneData(this.inputRightData),this.searchright=""},setOutTabLeftTable:function(t){this.$store.dispatch("realtime/initOutInputData",t)},outAlias:function(t,e){this.inputRightData.splice(e,1,dt({},this.inputRightData[e],{alias:t}))},toggleSelection:function(t){var e=this;t&&t.forEach((function(t){e.inputLeftData&&e.inputLeftData.forEach((function(n){t.name==n.name&&e.$refs.multipleTableLeft.toggleRowSelection(n)}))}))},toggleSelectionItem:function(t,e){var n=this;e.forEach((function(e){t&&t.forEach((function(t){e.name==t.name&&(console.log(" toggleSelection(rows) { if"),console.log("subRow",t),n.$refs.multipleTableLeft.toggleRowSelection(t))}))}))},filtertTableData:function(t,e,n){this.inputLeftData=_.filter(n,(function(e){return t?e.name.indexOf(t)>=0:e}))},filtertTableDataRight:function(t,e,n){this.inputRightData=_.filter(n,(function(e){return t?e.name.indexOf(t)>=0:e}))},cloneDeep:function(t){return _.cloneDeep(t)}}},gt=ht,bt=(n("7531"),Object(g["a"])(gt,ut,pt,!1,null,"3a843f94",null)),yt=bt.exports,vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"formitem"},[n(t.setTemplate(t.data.step.type),{tag:"component",attrs:{data:t.data.step}})],1)},Dt=[],jt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-collapse",{directives:[{name:"show",rawName:"v-show",value:t.isShowAd,expression:"isShowAd"}],attrs:{accordion:""}},[n("el-collapse-item",[n("template",{slot:"title"},[n("h3",{staticClass:"advanced-options"},[n("i",{staticClass:"fa fa-sort-amount-asc"}),t._v(" 高级选项 ")])]),n("el-form",{ref:"form",attrs:{model:t.form,"label-width":"150px"}},t._l(t.data.adformItemList,(function(e,a){return n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isshow,expression:"item.isshow"}],key:a,attrs:{prop:e.name,label:e.name,rules:{required:e.required,message:"",trigger:"blur"}}},[n("el-tooltip",{attrs:{lass:"item",effect:"dark",content:e.name,placement:"top"}},[n("i",{staticClass:"parIcon el-icon-warning"})]),"int"==e.type?n("el-input-number",{attrs:{min:1,max:100},on:{change:function(n){return t.changeFormItem(e,t.form[e.name])}},model:{value:t.form[e.name],callback:function(n){t.$set(t.form,e.name,n)},expression:"form[item.name]"}}):t._e(),"String"!=e.type&&"char"!=e.type||e.values?t._e():n("el-input",{nativeOn:{keyup:function(n){return t.changeFormItem(e,t.form[e.name])}},model:{value:t.form[e.name],callback:function(n){t.$set(t.form,e.name,n)},expression:"form[item.name]"}}),"String"==e.type&&e.values?n("el-select",{attrs:{placeholder:"请选择"},on:{change:function(n){return t.changeFormItem(e,t.form[e.name])}},model:{value:t.form[e.name],callback:function(n){t.$set(t.form,e.name,n)},expression:"form[item.name]"}},t._l(e.values?e.values:"",(function(t,e){return n("el-option",{key:e,attrs:{label:t,value:t}})})),1):t._e(),"boolean"==e.type?n("el-switch",{on:{change:function(n){return t.changeFormItem(e,t.form[e.name])}},model:{value:t.form[e.name],callback:function(n){t.$set(t.form,e.name,n)},expression:"form[item.name]"}}):t._e()],1)})),1)],2)],1)],1)},kt=[],Ot={watch:{"data.adformItemList":function(t){0==t.length?this.isShowAd=!1:this.isShowAd=!0},"data.adformItemData":function(t){this.form=t}},props:{data:{type:Object,default:!1}},components:{},data:function(){return{isShowAd:!0,form:{}}},computed:{},mounted:function(){},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{changeFormItem:function(t,e){this.$store.dispatch("realtime/setDataSetSelect",this.getParamertData(this.realtime.parametData,e,t.name))},getParamertData:function(t,e,n){var a={};return _.forEach(t,(function(t,i){a[i]=i==n?e:t})),a}}},Ct=Ot,wt=Object(g["a"])(Ct,jt,kt,!1,null,null,null),_t=wt.exports,It=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-form",{ref:"form",attrs:{model:t.form,"label-width":"150px"}},t._l(t.formItemList,(function(e,a){return n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isshow,expression:"item.isshow"}],key:a,attrs:{prop:e.name,label:e.name,rules:{required:!0,message:"",trigger:"blur"}}},[n("el-tooltip",{attrs:{lass:"item",effect:"dark",content:e.name,placement:"top"}},[n("i",{staticClass:"parIcon el-icon-warning"})]),"type"==e.name?n("el-select",{attrs:{placeholder:"请选择"},on:{change:function(e){return t.getFormItemByType(t.form.type)}},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.typeData,(function(t,e){return n("el-option",{key:e,attrs:{label:t,value:t}})})),1):t._e(),"String"!=e.type&&"long"!=e.type&&"char"!=e.type||e.values?t._e():n("el-input",{model:{value:t.form[e.name],callback:function(n){t.$set(t.form,e.name,n)},expression:"form[item.name]"}}),"String"==e.type&&e.values&&"type"!=e.name?n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form[e.name],callback:function(n){t.$set(t.form,e.name,n)},expression:"form[item.name]"}},t._l(e.values?e.values:"",(function(t,e){return n("el-option",{key:e,attrs:{label:t,value:t}})})),1):t._e(),"boolean"==e.type?n("el-switch",{model:{value:t.form[e.name],callback:function(n){t.$set(t.form,e.name,n)},expression:"form[item.name]"}}):t._e()],1)})),1),n("adItem",{attrs:{data:{adformItemList:t.adformItemList,adformItemData:t.adformItemData}}})],1)},Pt=[];function St(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function xt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?St(Object(n),!0).forEach((function(e){Lt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Lt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Tt={watch:{"realtime.setStepData":function(t){this.setFormData(t)},"realtime.initParametData":function(t){this.initForm(t)},form:function(t){this.$store.dispatch("realtime/setParamertData",t)}},props:{data:{type:Object,default:!1}},components:{adItem:_t},data:function(){return{form:{},formatData:["csv","parquet"],typeData:["HDFS","kafka"],formItemList:[],adformItemList:[],allformItemList:[],formItemData:[],adformItemData:{},allformItemData:[],unWatchlist:[]}},mounted:function(){},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{initForm:function(t){this.form=xt({},t,{},this.form)},setFormData:function(t){var e=this;this.$nextTick((function(){e.allformItemList=e.filterFormItem(t,e.form.format),e.adformItemList=Object(k["filter"])(e.allformItemList,(function(t){return t.advanced})),e.formItemList=Object(k["difference"])(e.allformItemList,e.adformItemList);var n=e.realtime.initParametData;e.allformItemData=e.setallformItemData(n),e.adformItemData=e.getFormItemData(e.adformItemList,e.allformItemData),e.initForm(xt({},e.form,{},e.setallformItemData(n))),e.formItemList=e.filterFormItem(e.formItemList,e.form.format);var a=Object(k["mapKeys"])(e.form,(function(t,e){return"form."+e}));Object(k["forEach"])(e.unWatchlist,(function(t){t()})),e.unWatchlist=[],f(Object(k["keys"])(a),Object(k["keys"])(e.form),e.unWatchlist,e.form,(function(t,n,a){e.$store.dispatch("realtime/setParamertData",a),"form.format"==t&&(e.formItemList=e.filterFormItem(e.formItemList,n))}),e)}))},filterFormItem:function(t,e){var n=this;return _.map(t,(function(t){return xt({},t,{isshow:n.isshow(t,e)})}))},isshow:function(t,e){return"separator"==t.name&&"csv"==e||"escapeChar"==t.name&&"csv"==e||"quoteChar"==t.name&&"csv"==e||"nullValue"==t.name&&"csv"==e||"jsonSchema"==t.name&&"csv"==e||!("separator"==t.name&&"csv"!=e||"escapeChar"==t.name&&"csv"!=e||"quoteChar"==t.name&&"csv"!=e||"nullValue"==t.name&&"csv"!=e||"jsonSchema"==t.name&&"csv"!=e)},getValueByName:function(t,e){var n="";return _.forEach(t,(function(t,a){t.name==e&&(n=t.defaultValue)})),n},getFormItemByType:function(t){var e=this;this.formItemList=[],stepsettings("sink_"+t).then((function(t){e.getStepConfiug(t)}),(function(t){}))},getFormItemData:function(t,e){var n={};return _.forEach(t,(function(t){_.forEach(e,(function(e,a){a==t.name&&(n[a]=e)}))})),n},setallformItemData:function(t){var e=this,n={},a=Object(k["map"])(this.allformItemList,(function(t){return t.name}));return Object(k["forEach"])(a,(function(a){n[a]="processOnce"==a?""!=t[a]&&t[a]:t[a]?t[a]:e.getValueByName(e.allformItemList,a)})),n}}},Et=Tt,Rt=Object(g["a"])(Et,It,Pt,!1,null,null,null),$t=Rt.exports,Mt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"sink-step"},[n("el-form",{ref:"form",attrs:{model:t.form,"label-width":"150px"}},[n("el-form-item",{attrs:{label:"dataset",rules:[{required:!0,message:"",trigger:"blur"}]}},[n("el-tooltip",{attrs:{lass:"item",effect:"dark",content:"1.数据集名称,从资源目录选择或编辑创建 2.格式为字符串：字符/数字/下划线/-/的组合",placement:"top"}},[n("i",{staticClass:"parIcon el-icon-warning"})]),n("el-input",{attrs:{placeholder:"请选择内容",model:t.form.datasetName,disabled:!0,name:"dataset"},model:{value:t.form.datasetName,callback:function(e){t.$set(t.form,"datasetName",e)},expression:"form.datasetName"}},[n("el-button",{attrs:{slot:"append",icon:"icon iconfont icon-ir-search",name:"dataSetInq"},on:{click:t.selectDataset},slot:"append"})],1),t.form.datasetName?t._e():n("p",{staticClass:"sign"},[t._v("选择内容不能为空")])],1),n("el-form-item",{attrs:{label:"type",rules:[{required:!0,message:"",trigger:"change"}]}},[n("el-tooltip",{attrs:{lass:"item",effect:"dark",content:"type",placement:"top"}},[n("i",{staticClass:"parIcon el-icon-warning"})]),n("el-input",{attrs:{disabled:"",placeholder:"请选择"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}})],1),t._l(t.formItemList,(function(e,a){return n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.isshow,expression:"item.isshow"}],key:a,attrs:{prop:e.name,label:e.name,rules:{required:e.required,message:"",trigger:"blur"}}},[n("el-tooltip",{attrs:{lass:"item",effect:"dark",content:e.name,placement:"top"}},[n("i",{staticClass:"parIcon el-icon-warning"})]),"String"!=e.type&&"char"!=e.type||e.values?t._e():n("el-input",{model:{value:t.form[e.name],callback:function(n){t.$set(t.form,e.name,n)},expression:"form[item.name]"}}),"String"==e.type&&e.values?n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form[e.name],callback:function(n){t.$set(t.form,e.name,n)},expression:"form[item.name]"}},t._l(e.values?e.values:"",(function(t,e){return n("el-option",{key:e,attrs:{label:t,value:t}})})),1):t._e(),"boolean"==e.type?n("el-switch",{model:{value:t.form[e.name],callback:function(n){t.$set(t.form,e.name,n)},expression:"form[item.name]"}}):t._e()],1)}))],2),n("adItem",{attrs:{data:{adformItemList:t.adformItemList,adformItemData:t.adformItemData}}})],1)},Nt=[];function zt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zt(Object(n),!0).forEach((function(e){At(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function At(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var qt={watch:{"realtime.setStepData":function(t){this.setFormData(t)},"realtime.initParametData":function(t){this.initForm(t),Object(k["isEmpty"])(t)&&(this.formItemList=[])},"realtime.selectCheckedDataSet":function(t){this.initForm({datasetName:t.datasetName,schemaId:t.schemaId,type:t.storage})},form:function(t){this.$store.dispatch("realtime/setParamertData",t)}},computed:{},props:{data:{type:Object,default:{}}},components:{adItem:_t},data:function(){return{form:{},formatData:["csv","parquet"],dialogDataSetVisible:!1,typeData:["HDFS","KAFKA"],formItemList:[],adformItemList:[],allformItemList:[],formItemData:[],adformItemData:{},allformItemData:[],unWatchlis:[]}},mounted:function(){},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){this.$nextTick((function(){}))},beforeDestroy:function(){},destroyed:function(){},methods:{setUpWatchers:function(t,e){var n=this,a=function(a){var i=e[a],s=t[a];n.$watch(s,(function(t){var e={};e[i]=t,n.$store.dispatch("realtime/setParamertData",val.fields),"form.format"==s&&(n.formItemList=n.filterFormItem(n.formItemList,t))}))};for(var i in t)a(i)},getFormItemData:function(t,e){var n={};return _.forEach(t,(function(t){_.forEach(e,(function(e,a){a==t.name&&(n[a]=e)}))})),n},initForm:function(t){this.form=t},selectDataset:function(){this.openDialog(!0)},cancelDatasetDialog:function(){this.dialogDataSetVisible=!1},submitDataSet:function(){},selectChange:function(){},setFormData:function(t){var e=this;this.$nextTick((function(){e.allformItemList=e.filterFormItem(t,e.form.format),e.adformItemList=Object(k["filter"])(e.allformItemList,(function(t){return t.advanced})),e.formItemList=Object(k["difference"])(e.allformItemList,e.adformItemList);var n=e.realtime.initParametData;e.allformItemData=e.setallformItemData(n),e.adformItemData=e.getFormItemData(e.adformItemList,e.allformItemData),e.initForm(Ft({},e.setallformItemData(n),{},e.form));var a=Object(k["mapKeys"])(e.form,(function(t,e){return"form."+e}));Object(k["forEach"])(e.unWatchlist,(function(t){t()})),e.unWatchlist=[],f(Object(k["keys"])(a),Object(k["keys"])(e.form),e.unWatchlist,e.form,(function(n,a,i){e.$store.dispatch("realtime/setParamertData",t.fields),"form.format"==n&&(e.formItemList=e.filterFormItem(e.formItemList,a))}),e)}))},filterFormItem:function(t,e){var n=this;return _.map(t,(function(t){return Ft({},t,{isshow:n.isshow(t,e)})}))},isshow:function(t,e){return"separator"==t.name&&"csv"==e||"escapeChar"==t.name&&"csv"==e||"quoteChar"==t.name&&"csv"==e||"nullValue"==t.name&&"csv"==e||!("separator"==t.name&&"csv"!=e||"escapeChar"==t.name&&"csv"!=e||"quoteChar"==t.name&&"csv"!=e||"nullValue"==t.name&&"csv"!=e||"jsonSchema"==t.name&&"json"!=e)},getValueByName:function(t,e){var n="";return _.forEach(t,(function(t,a){t.name==e&&(n=t.defaultValue)})),n},setallformItemData:function(t){var e=this,n={},a=Object(k["map"])(this.allformItemList,(function(t){return t.name}));return Object(k["forEach"])(a,(function(a){n[a]="processOnce"==a?""!=t[a]&&t[a]:t[a]?t[a]:e.getValueByName(e.allformItemList,a)})),n}}},Ut=qt,Ht=(n("12a3"),Object(g["a"])(Ut,Mt,Nt,!1,null,null,null)),Vt=Ht.exports,Bt={watch:{},props:{data:{type:Object,default:!1}},components:{adItem:_t},data:function(){return{}},mounted:function(){},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{setTemplate:function(t){switch(t){case"sink":return $t;case"source":return Vt;default:}}}},Wt=Bt,Zt=(n("4b36"),Object(g["a"])(Wt,vt,Dt,!1,null,null,null)),Jt=Zt.exports,Yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"nodeTable block__list_tags",attrs:{id:"input"}},[n("div",{staticClass:"block__list block__list_words blockLeft"},[n("div",{staticClass:"block__list-title"},[n("span",[t._v("备选字段")]),n("el-input",{staticClass:"fieldsInput",attrs:{placeholder:"请输入字段名称","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(e){t.filtertTableData(t.searchAlternative,t.inputLeftData,t.getMapCheckedData(t.realtime.initOutInputData))}},model:{value:t.searchAlternative,callback:function(e){t.searchAlternative=e},expression:"searchAlternative"}}),n("i",{staticClass:"ns_fields3 icon iconfont icon-ir-copy",attrs:{title:"导入表格内字段"},on:{click:function(e){return t.inputFieldsImport(t.inputLeftData)}}}),n("i",{staticClass:"ns_fields1 el-icon-plus",attrs:{title:"新增已选字段"},on:{click:t.addInputLeft}})],1),n("div",[n("el-table",{ref:"multipleTableLeft",staticStyle:{width:"100%"},attrs:{"tooltip-effect":"dark",data:t.inputLeftData.slice((t.inputLeftCurrentPage-1)*t.inputLeftPagesize,t.inputLeftCurrentPage*t.inputLeftPagesize),height:"25vh"},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{fixed:"",index:t.inputLeftIndexMethod,type:"index",width:"60"}}),n("el-table-column",{attrs:{prop:"name",label:"字段名"}}),n("el-table-column",{attrs:{type:"selection",width:"55"}})],1)],1),n("el-pagination",{attrs:{small:"","current-page":t.inputLeftCurrentPage,"page-sizes":[10,20,50,100],"page-size":t.inputLeftPagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.inputLeftData&&t.inputLeftData.length},on:{"size-change":t.inputLeftHandleSizeChange,"current-change":t.inputLeftHandleCurrentChange}})],1),n("div",{staticClass:"block__list block__list_words blockRight"},[n("div",{staticClass:"block__list-title"},[n("span",[t._v("已选字段")]),n("el-input",{staticClass:"fieldsInput",attrs:{placeholder:"请输入字段名称","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(e){return t.filtertTableDataRight(t.searchright,t.inputRightData,t.inputRighCloneData)}},model:{value:t.searchright,callback:function(e){t.searchright=e},expression:"searchright"}}),n("span",{staticClass:"removeAllFields",attrs:{title:"删除全部已选字段"},on:{click:t.removeOutSelAllField}},[n("i",{staticClass:"fa fa-trash-o"})])],1),n("div",[n("ol",{attrs:{id:"input-2"}},[n("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.inputRightData.slice((t.inputRightCurrentPage-1)*t.inputRightPagesize,t.inputRightCurrentPage*t.inputRightPagesize),height:"25vh"}},[n("el-table-column",{attrs:{fixed:"",index:t.inputRightIndexMethod,type:"index",width:"60"}}),n("el-table-column",{attrs:{prop:"name",label:"字段名"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{class:e.row.isillegality?"righttb":""},[t._v(t._s(e.row.name)+" "+t._s(e.row.isillegality))])]}}])}),n("el-table-column",{attrs:{prop:"alias",label:"别名"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input",{attrs:{placeholder:"别名"},nativeOn:{keyup:function(n){return t.outAlias(e.row.alias,e.$index)}},model:{value:e.row.alias,callback:function(n){t.$set(e.row,"alias",n)},expression:"scope.row.alias"}})]}}])}),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-col",{staticClass:"removeFields",attrs:{span:3}},[n("i",{staticClass:"el-icon-close",on:{click:function(n){return t.removeOutSelThisField(e.row.name,e.$index)}}})])]}}])})],1)],1),n("el-pagination",{attrs:{small:"","current-page":t.inputRightCurrentPage,"page-sizes":[10,20,50,100],"page-size":t.inputRightPagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.inputRightData.length},on:{"size-change":t.inputRightHandleSizeChange,"current-change":t.inputRightHandleCurrentChange}})],1)]),n("p",[t._v("提示：别名允许的字符包括字母,数字和下划线.")]),0!=t.Missing.length?n("p",[t._v("缺失 "+t._s(t.Missing.length)+"个")]):t._e(),0!=t.Missing.length?n("p",{staticClass:"Missing"},[t._v(t._s(t.Missing.toString()))]):t._e(),0!=t.illegality.length?n("p",[t._v("非法 "+t._s(t.illegality.length)+"个")]):t._e(),0!=t.illegality.length?n("p",{staticClass:"illegality"},[t._v(t._s(t.illegality.toString()))]):t._e()])])},Kt=[];function Gt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Xt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Gt(Object(n),!0).forEach((function(e){Qt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Qt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var te={watch:{"realtime.selectCheckedDataSet":function(t){this.$store.dispatch("realtime/initOutInputData",t.fields)},"realtime.initOutInputData":function(t){this.inputLeftData=this.getMapCheckedDataLeft(_.map(t,(function(t){return{alias:"",description:t.description,column:t.alias||t.column,type:t.type}})))},"realtime.initCheckedOutData":function(t){0==t.length&&(this.inputRightData=[]),this.inputRightData=this.getMapCheckedDataright(t),this.setInputRighCloneData(this.inputRightData)},inputLeftData:function(t){},inputRightData:function(t,e){this.$store.dispatch("realtime/setOutCheckedData",_.map(t,(function(t){return{alias:t.alias,description:t.description,name:t.name,type:t.type}})))},data:function(t){this.searchAlternative="",this.searchright="",this.inputRightData=this.mapCheckedData(this.realtime.initCheckedOutData)}},props:{data:{type:Object,default:!1}},components:{},data:function(){return{inputLeftData:[],inputRightData:[],inputLeftCurrentPage:1,inputLeftPagesize:10,inputRightCurrentPage:1,inputRightPagesize:10,searchAlternative:"",selectColumn:[],multipleSelection:[],searchright:"",rightTableList:[],inputRighCloneData:[],illegality:[],Missing:[]}},computed:{},mounted:function(){},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{setMissAndIllegality:function(t,e){this.Missing=this.setMissing(t,e),this.illegality=this.setIllegality(t,e)},getMapCheckedDataright:function(t){return _.map(t,(function(t){return{alias:t.alias,description:t.description,name:t.column,type:t.type}}))},mpaData:function(t){return _.map(t,(function(t){return t.column||t.name}))},setMapCheckedDataright:function(t,e){var n=[];return _.forEach(t,(function(t){_.forEach(e,(function(e){t.name==e?n.push(Xt({},t,{isillegality:!0})):n.push(Xt({},t))}))})),n},setIllegality:function(t,e){return _.differenceWith(this.mpaData(e),this.mpaData(t),_.isEqual)},setMissing:function(t,e){return _.differenceWith(this.mpaData(t),this.mpaData(e),_.isEqual)},setInputRighCloneData:function(t){this.inputRighCloneData=_.cloneDeep(t)},getMapCheckedDataLeft:function(t){return _.map(t,(function(t){return{alias:"",description:t.description,name:t.column,type:t.type}}))},getMapCheckedData:function(t){return _.map(t,(function(t){return{alias:t.alias,description:t.description,name:t.alias||t.column,type:t.type}}))},mapCheckedData:function(t){return _.map(t,(function(t){return{alias:t.alias,description:t.description,name:t.column,type:t.type}}))},handleSelectionChange:function(t){this.multipleSelection=t},inputLeftFocus:function(){},inputLeftKeydown:function(){},getInputRow:function(t){return t.name},inputLeftHandleSizeChange:function(t){this.inputLeftPagesize=t},inputLeftHandleCurrentChange:function(t){this.inputLeftCurrentPage=t},inputLeftIndexMethod:function(t){return this.inputLeftPagesize*(this.inputLeftCurrentPage-1)+t+1},inputLefthandleSelectionChange:function(t){this.selectColumn=t},inputRightHandleSizeChange:function(t){this.inputRightPagesize=t},inputRightHandleCurrentChange:function(t){this.inputRightCurrentPage=t},inputRightIndexMethod:function(t){return this.inputRightPagesize*(this.inputRightCurrentPage-1)+t+1},inputFieldsImport:function(t){var e=this;this.$confirm("确认导入全部数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$message({type:"success",message:"导入成功!"}),e.inputRightData=t,e.setInputRighCloneData(t),document.querySelector(".v-modal").remove()})).catch((function(){e.$message({type:"info",message:"已取消"}),document.querySelector(".v-modal").remove()}))},addInputLeft:function(){this.inputRightData=this.multipleSelection,this.setInputRighCloneData(this.multipleSelection)},removeOutSelAllField:function(){this.inputRightData=[],this.inputRighCloneData=[],this.$refs.multipleTableLeft.clearSelection()},removeOutSelThisField:function(t,e){this.inputRightData=_.filter(this.inputRighCloneData,(function(e){return e.name!=t})),this.setInputRighCloneData(this.inputRightData),this.searchright=""},outAlias:function(t,e){this.inputRightData.splice(e,1,Xt({},this.inputRightData[e],{alias:t}))},toggleSelection:function(t){var e=this;t&&t.forEach((function(t){e.inputLeftData&&e.inputLeftData.forEach((function(n){t.name==n.name&&e.$refs.multipleTableLeft.toggleRowSelection(n)}))}))},filtertTableData:function(t,e,n){this.inputLeftData=_.filter(n,(function(e){return t?e.name.indexOf(t)>=0:e}))},filtertTableDataRight:function(t,e,n){this.inputRightData=_.filter(n,(function(e){return t?e.name.indexOf(t)>=0:e}))}}},ee=te,ne=(n("4d0b"),Object(g["a"])(ee,Yt,Kt,!1,null,"2ae6f66e",null)),ae=ne.exports;function ie(t){return ce(t)||oe(t)||re(t)||se()}function se(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function re(t,e){if(t){if("string"===typeof t)return le(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?le(t,e):void 0}}function oe(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function ce(t){if(Array.isArray(t))return le(t)}function le(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function ue(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function pe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ue(Object(n),!0).forEach((function(e){fe(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function fe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var de={watch:{data:function(t){this.ruleForm={newName:t.step.name}},"realtime.loadingStatus":function(t){this.loading=t},"realtime.selectCheckedDataSet":function(t){"source"==this.data.step.type&&this.getDatasettype(t)}},props:{data:{type:Object,default:!1}},components:{},data:function(){return{activeName:"0",loading:!1,labelPosition:"left",ruleForm:{newName:""},rules:{newName:[{required:!0,message:"节点名称不能为空",trigger:"blur"},{min:1,max:100,message:"节点显示名称，最长100",trigger:"blur"}]},splitEndpoint:[]}},computed:{},mounted:function(){},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{modifyLodadingStatus:function(){this.loading=!1},getCheckedOutData:function(t){var e=this;if("split"==t){var n={};return _.forEach(this.realtime.splitEndpoint,(function(t){n[t]=e.mapCheckedData(e.realtime.checkedOutData)})),n}return{output:this.mapCheckedData(this.realtime.checkedOutData)}},setCurrentStep:function(){this.closeDialog(),this.$emit("modifyFlowData",{step:this.data.step,data:{parametData:this.realtime.parametData,checkedOutData:this.getCheckedOutData(this.data.step.type),checkedinPUTData:this.realtime.checkedinPUTData}})},mapCheckedData:function(t){return _.map(t,(function(t){return{alias:t.alias,description:t.description,column:t.name,type:t.type}}))},closeDialog:function(){this.activeName="0",this.data.dialogVisible=!1,this.$store.dispatch("realtime/setDataSetSelect",{}),this.$store.dispatch("realtime/initParametData",{}),this.$store.dispatch("realtime/initOutCheckedData",[]),this.$store.dispatch("realtime/initInputCheckedData",[]),this.$store.dispatch("realtime/initInputData",[]),this.$store.dispatch("realtime/modifyLoadingStatus",!1),this.$store.dispatch("realtime/setAdList",[]),this.$store.dispatch("realtime/getStepConfiug",[])},setTabTemplate:function(t){switch(t){case"input":return yt;case"parameter":return Jt;case"output":return ae;default:}},getinputConfigurations:function(t,e){if("source_dummy"!=t.type)return"join"==t.type&&e.left&&!e.right||e.right&&!e.left?t.inputConfigurations:e},handleClick:function(t,e){if("source"!=this.data.step.type&&"sink"!=this.data.step.type&&"output"!=t.label){if("join"==this.data.step.type&&"input"==t.label){var n=this.data.nodeSetTab[parseInt(this.activeName)].targetInput;this.initInputTab(this.data.step,n,n)}this.modifyLoadingStatus(!1)}},handleClose:function(t){this.$confirm("确认关闭？").then((function(e){data.dialogVisible=!1,t()})).catch((function(t){}))},initInputForm:function(t,e){var n=_.find(this.data.links,(function(n){return"join"==t.type?n.target==t.id&&n.targetInput==e:n.target==t.id})),a=_.find(this.data.steps,(function(t){return t.id==n.source})).outputConfigurations,i="split"==this.data.pre.type?a[n.sourceOutput]:a.output;this.$store.dispatch("realtime/initInputData",_.map(i,(function(t){return{alias:"",description:"",column:t.alias||t.column,type:t.type}})))},initOutTab:function(t){this.$store.dispatch("realtime/initOutCheckedData",this.getInitOutCheckedData(t))},getInitOutCheckedData:function(t){return"split"==t.type?_.map(this.getSplitOutputData(t.outputConfigurations).valueList,(function(t){return pe({},t,{column:t.column})})):t.outputConfigurations.output},initInputTab:function(t,e,n){this.initInputForm(t,e),this.$store.dispatch("realtime/initInputCheckedData",t.inputConfigurations?t.inputConfigurations[n]:[])},initInputItem:function(){this.$store.dispatch("realtime/initParametData",this.data.step.stepSettings),"source"!=this.data.step.type&&"source_dummy"!=this.data.step.type?("filter"!=this.data.step.type&&"aggregate"!=this.data.step.type&&"transform"!=this.data.step.type&&"sql"!=this.data.step.type&&"lookup"!=this.data.step.type&&"split"!=this.data.step.type||(this.initInputTab(this.data.step,this.data.nodeSetTab[0].targetInput,"input"),this.initOutTab(this.data.step)),"join"==this.data.step.type&&(this.initInputTab(this.data.step,this.data.nodeSetTab[parseInt(this.activeName)].targetInput,this.data.nodeSetTab[parseInt(this.activeName)].targetInput),this.initOutTab(this.data.step)),"sink"==this.data.step.type&&this.initInputTab(this.data.step,this.data.nodeSetTab[0].targetInput,"input")):this.$store.dispatch("realtime/initOutCheckedData",this.data.step.outputConfigurations?this.data.step.outputConfigurations.output:[])},showDailog:function(){var t=this;this.activeName="0";var e=this.data.step.type;this.data.step.stepSettings.type;if("source"!=e&&"sink"!=e||Object(d["d"])(e).then((function(e){t.$store.dispatch("realtime/getStepConfiug",e.data)}),(function(t){})),this.initInputItem(),"split"==this.data.step.type){var n=this.getSplitOutputData(this.data.step.outputConfigurations),a=(n.valueList,n.keyList);this.getSplitEndpoint(a)}},getJoinConditionData:function(t,e){var n={};return _.forEach(t,(function(t){_.forEach(e,(function(e){t.source==e.id&&"right"==t.targetInput&&(n=pe({},n,{right:_.map(e.outputConfigurations.output,(function(t){return t.column}))})),t.source==e.id&&"left"==t.targetInput&&(n=pe({},n,{left:_.map(e.outputConfigurations.output,(function(t){return t.column}))}))}))})),n},getSplitOutputData:function(t){var e=[],n=[];return _.forEach(t,(function(t,a){e=[].concat(ie(e),ie(t)),n=[].concat(ie(n),[a])})),{valueList:_.map(_.uniq(_.map(e,(function(t){return JSON.stringify(t)}))),(function(t){return JSON.parse(t)})),keyList:n}},getOutPutData:function(t,e){var n=this;outputStep(t).then((function(t){if(200==t.status){if("split"==n.data.step.type){var a=n.getSplitOutputData(t.data),i=(a.valueList,a.keyList);n.getSplitEndpoint(i),n.$store.dispatch("realtime/initOutInputData",t.data.output)}else n.$store.dispatch("realtime/initOutInputData",t.data.output);e()}else n.$message.error(t.message)}),(function(t){}))},getFormData:function(t,e){return _.forEach(e,(function(e,n){_.forEach(t,(function(t,n){e.name==n&&t&&(e.defaultValue=t)}))})),e},getDatasettype:function(t){var e=this;if("undefined"==typeof t.storage)return!1;var n=this.data.step.type;stepsettings("sink"==n||"source"==n?n+"_"+t.storage:n).then((function(n){e.getStepConfiug(e.getFormData(t.storageConfigurations,n))}),(function(t){}))}}},me=de,he=(n("a389"),Object(g["a"])(me,ct,lt,!1,null,null,null)),ge=he.exports,be=n("e193"),ye=n.n(be),ve=n("81b0"),De=n.n(ve);function je(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function ke(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?je(Object(n),!0).forEach((function(e){Oe(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Oe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ce={name:"jsplumb-chart",watch:{},props:{},components:{vaside:y,stepdialog:ge,jsplumbchart:it},data:function(){return{jsplumbchartOption:{isPanZoom:!0,steps:this.steps,links:this.links,container:"workplace",nodeType:"flowchartnode",jsPlumb:ye.a.jsPlumb},nodeTab:[{title:"输入",name:"input",icon:"fa fa-sign-in",lable:"input"},{title:"参数",name:"parameter",icon:"fa fa-gear",lable:"parameter"},{title:"输出",name:"output",icon:"fa fa-sign-out",lable:"output"}],dialogOption:{},input1:"",links:[],steps:[],matrix:"",operationType:"copy",input1Test:"",flowData:{}}},mounted:function(){this.$route.query.row&&(this.flowData=JSON.parse(ot["Base64"].decode(decodeURIComponent(this.$route.query.row))),this.steps=this.flowData.steps,this.links=this.flowData.links,this.input1=this.flowData.flowName,this.matrix=this.flowData.matrix,this.jsplumbchartOption={isPanZoom:!0,steps:this.steps,links:this.links,container:"workplace",nodeType:"flowchartnode",jsPlumb:this.jsPlumb,matrix:this.flowData.matrix&&JSON.parse(this.flowData.matrix)})},beforeCreate:function(){},created:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{modifyJsplumbchartOption:function(t){this.jsplumbchartOption=t},handleDragover:function(){},copyNode:function(t){var e="";return ke({},t,{id:this.isExitStepID(t.id)?t.id+"_new"+e:t.id})},handleDrop:function(t){console.log("handleDrop(val) {",t);var e="",n="",a=this.$refs.jsplumbchart.jsplumbInstance.getContainer();t.drawIcon?(e=this.getCurrentNode(t,this.jsplumbchartOption.isPanZoom?a:""),n=a&&a.getBoundingClientRect(),this.operationType="add"):e=this.copyNode(t),this.steps.push(e),this.jsplumbchartOption=ke({},this.jsplumbchartOption,{steps:this.steps,links:this.links,operationType:this.operationType,containerRect:n})},isExitStepID:function(t){var e=!1;return De.a.forEach(this.steps,(function(n){n.id==t&&(e=!0)})),e},getScale:function(t){var e,n=t.getContainer();if(t.pan){var a=t.pan.getTransform(),i=a.scale;e=i}else{var s=window.getComputedStyle(n).transform;e=1*s.split(", ")[3]}return t.setZoom(e),e},getCurrentNode:function(t,e){var n="",a=t.drawIcon.id+"_"+(this.steps.length+1),i=this.isExitStepID(a)?a+"_new"+n:a,s={id:this.isExitStepID(i)?i+"_new":i,name:t.drawIcon.name,type:t.drawIcon.type,x:De.a.isElement(e)?event.pageX:event.offsetX,y:De.a.isElement(e)?event.pageY:event.offsetY,stepSettings:t.drawIcon.stepSettings},r={outputConfigurations:{output:[]}},o={inputConfigurations:{input:[]}};switch(t.drawIcon.type){case"source":case"source_dummy":return ke({},s,{},r);case"sink":return ke({},s,{},o);default:return ke({},s,{},o,{},r)}},saveFlow:function(){var t=this;if(this.input1){var e={};e=this.jsplumbchartOption.isPanZoom?{flowName:this.input1,links:this.links,steps:this.steps,date:rt()().format("YYYY-MM-DD HH:mm:ss"),matrix:JSON.stringify(this.$refs.jsplumbchart.jsplumbInstance.pan.getTransform())}:{flowName:this.input1,links:this.links,steps:this.steps,date:rt()().format("YYYY-MM-DD HH:mm:ss")},this.$route.query.row?Object(d["f"])(ke({},e,{id:this.flowData.id})).then((function(){t.$router.go(-1)})):Object(d["a"])(e).then((function(){t.$router.go(-1)}))}else this.$message({showClose:!0,message:"流程名称不可以为空",type:"error"})},modifyChart:function(t){this.steps=t.stepData,this.links=t.links,this.jsplumbchartOption=ke({},this.jsplumbchartOption,{steps:t.stepData,links:t.links})},clearall:function(){this.steps=[],this.links=[],this.$refs.jsplumbchart.reset()},reset:function(){this.$refs.jsplumbchart.resume()},nodedblClick:function(t){this.isOpenStepDialog(t)?this.$message({message:"请建立正确的连接！",type:"error"}):this.dialogOption={dialogVisible:!0,step:t,filterLinks:this.filterLinks(t),preSteps:this.getPreNodes(this.filterLinks(t)),pre:this.getPreNode(this.findLinks(t)),nodeSetTab:this.setNodeSetTab(t,this.getPreNode(this.findLinks(t))),steps:this.steps,links:this.links}},isOpenStepDialog:function(t){return"source"!=t.type&&"source_dummy"!=t.type&&("join"==t.type&&(0==this.filterLinks(t).length||1==this.filterLinks(t).length)||(!("filter"!=t.type&&"sink"!=t.type&&"aggregate"!=t.type&&"transform"!=t.type&&"lookup"!=t.type&&"split"!=t.type&&"sql"!=t.type||this.filterLinks(t)[0])||void 0))},filterLinks:function(t){return De.a.filter(this.links,(function(e){return e.target==t.id}))},setNodeSetTab:function(t,e){var n=this;if("sink"==t.type)return[ke({},this.nodeTab[0],{title:"输入 ("+e.name+")"}),this.nodeTab[1]];if("source"==t.type||"source_dummy"==t.type)return[this.nodeTab[1],this.nodeTab[2]];if("filter"==t.type||"aggregate"==t.type||"sql"==t.type||"transform"==t.type||"lookup"==t.type||"split"==t.type)return[ke({},this.nodeTab[0],{title:"输入 ("+e.name+")"}),this.nodeTab[1],this.nodeTab[2]];if("join"==t.type){var a=[];return De.a.forEach(this.getLinks(t),(function(t){a.push(ke({},n.nodeTab[0],{title:t.targetInput+" ("+n.getPreNode(t).name+")",targetInput:t.targetInput}))})),[].concat(a,[this.nodeTab[1],this.nodeTab[2]])}},getPreNodes:function(t){var e=this,n=[];return De.a.forEach(t,(function(t){De.a.forEach(e.steps,(function(e){t.source==e.id&&n.push(e)}))})),n},getPreNode:function(t){return De.a.find(this.steps,(function(e){return t?e.id==t.source:""}))},findLinks:function(t){return De.a.find(this.links,(function(e){return e.target==t.id}))},modifyFlowData:function(t){this.steps=De.a.map(this.steps,(function(e){return e.type==t.step.type&&"source"==t.step.type&&e.id==t.step.id?ke({},e,{stepSettings:t.data.parametData,outputConfigurations:t.data.checkedOutData}):e.type!=t.step.type||"source"==t.step.type&&"sink"==t.step.type||e.id!=t.step.id?e.type==t.step.type&&"sink"==t.step.type&&e.id==t.step.id?ke({},e,{stepSettings:t.data.parametData,inputConfigurations:t.data.checkedinPUTData}):e:ke({},e,{stepSettings:t.data.parametData,outputConfigurations:t.data.checkedOutData,inputConfigurations:t.data.checkedinPUTData})}))}}},we=Ce,_e=(n("4243"),Object(g["a"])(we,a,i,!1,null,null,null));e["default"]=_e.exports},"3edb":function(t,e,n){},4243:function(t,e,n){"use strict";var a=n("3edb"),i=n.n(a);i.a},4678:function(t,e,n){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"25548","./bs.js":"25548","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c96","./es-us.js":"55c96","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function i(t){var e=s(t);return n(e)}function s(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=s,t.exports=i,i.id="4678"},"4b36":function(t,e,n){"use strict";var a=n("95da"),i=n.n(a);i.a},"4bf8":function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return s})),n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"f",(function(){return c})),n.d(e,"d",(function(){return l}));var a=n("b775"),i=function(){return Object(a["a"])({url:"/steplist",method:"get"})},s=function(t){return Object(a["a"])({url:"/flowlist?_page="+t.currentPage+"&_limit="+t.pageSize,method:"get"})},r=function(t){return Object(a["a"])({url:"/add/flow",method:"post",data:t})},o=function(t){return Object(a["a"])({url:"/del/flow/"+t,method:"DELETE"})},c=function(t){return Object(a["a"])({url:"/modify/flow/"+t.id,method:"PUT",data:t})},l=function(t){return Object(a["a"])({url:"/rtc/steps/settings/"+t,method:"get",data:t})}},"4d0b":function(t,e,n){"use strict";var a=n("c15d"),i=n.n(a);i.a},7531:function(t,e,n){"use strict";var a=n("836d"),i=n.n(a);i.a},"7fc7":function(t,e,n){},"836d":function(t,e,n){},9101:function(t,e,n){},9481:function(t,e,n){"use strict";var a=n("7fc7"),i=n.n(a);i.a},"95da":function(t,e,n){},"9eae":function(t,e,n){},a389:function(t,e,n){"use strict";var a=n("dcfa"),i=n.n(a);i.a},b775:function(t,e,n){"use strict";var a=n("bc3a"),i=n.n(a),s=n("5c96"),r=n("ca00"),o=Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_API?Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BASE_API:Object(r["b"])(),c=Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_API_ROOT;o+=c;var l=i.a.create({baseURL:o,timeout:5e3});l.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)})),l.interceptors.response.use((function(t){return t}),(function(t){if(t&&t.response){var e=t.response.data.message;switch(t.response.status){case 400:t.response.message=e||"请求错误",Object(s["Message"])({message:"请求错误",type:"warning"});break;case 401:t.response.message=e||"未授权，请登录",Object(s["Message"])({message:"未授权，请登录",type:"warning"});break;case 403:t.response.message=e||"拒绝访问",Object(s["Message"])({message:"拒绝访问",type:"warning"});break;case 404:t.response.message=e||"请求地址出错: ".concat(t.response.config.url),Object(s["Message"])({message:"请求地址出错: ${err.response.config.url}",type:"warning"});break;case 405:t.response.message=e||"拒绝访问",Object(s["Message"])({message:"拒绝访问",type:"warning"});break;case 408:t.response.message=e||"请求超时",Object(s["Message"])({message:"请求超时",type:"warning"});break;case 500:if(t.response.message=e||"服务器内部错误","io.jsonwebtoken.ExpiredJwtException"===t.response.data["exception"]){var n="Token过期 超时,请重新登陆";!0===confirm(n)&&location.reload()}break;case 501:t.response.message=e||"服务未实现",Object(s["Message"])({message:"服务未实现",type:"warning"});break;case 502:t.response.message=e||"网络错误",Object(s["Message"])({message:"网络错误",type:"warning"});break;case 503:t.response.message=e||"服务不可用",Object(s["Message"])({message:"服务不可用",type:"warning"});break;case 504:t.response.message=e||"网络超时",Object(s["Message"])({message:"网络超时",type:"warning"});break;case 505:t.response.message=e||"HTTP版本不受支持",Object(s["Message"])({message:"HTTP版本不受支持",type:"warning"});break;default:t.response.message=e}}return Promise.reject(t)})),e["a"]=l},c15d:function(t,e,n){},dcfa:function(t,e,n){},fa36:function(t,e,n){"use strict";var a=n("9eae"),i=n.n(a);i.a}}]);